<html>
  <head>
    <title>Graph and PowerShell Blog</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
          
    <style>
      body{
        margin: 0px;
        padding: 0px;
    }
 
h1 {
        margin-top: 0px;
    }
	     
	  
      .dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  text-align:left;
  background-color: #ffffff;
  font-family:Montserrat, sans-serif;
  font-size:13px;
  min-width: 380px;
  box-shadow: 0px 2px 2px 0px rgba(0,0,0,0.2);
  padding: 6px 6px;
  z-index: 1;
}

.dropdown:hover .dropdown-content {
  display: block;
}
      
	    
a.dropbtn:link {color: #564c4d; text-decoration: none;}
a.dropbtn:visited {color: #564c4d; text-decoration: none;}
a.dropbtn:hover {color: #564c4d; text-decoration: none;}
	    
a.two:link {color: #564c4d; text-decoration: none;}
a.two:visited {color: #564c4d; text-decoration: none;}
a.two:hover {color: #447EAE; text-decoration: none;}
	    
	.content { font-family:verdana; font-size:12px; ; color:#564c4d; width:850px; text-align:left; }
	.headline { font-family:verdana; font-size:22px; color:#564c4d; width:850px; text-align:left; }
	.datestamp { font-family:verdana; font-size:10px; color:#564c4d; width:850px; text-align:left; }
	.imagecaption { font-style: italic; }
	.imageMain { border: 5px solid #564c4d; }
	.indexTable td { font-family:verdana; font-size:14px; ; color:#564c4d; }
	    
      </style>
    
  </head>
  
  <body>
    
    <table style='width:100%; padding:0px; border-collapse: collapse;'>
      <tr><td style='height:25px; color:#564c4d; width:50%; font-size:25px; font-family:Montserrat, sans-serif; text-align:left;'><a href='index.html' class=dropbtn><img src='giraffe3.png' style='height:55px; padding:10px; vertical-align:middle; border:0px;'>Graph and PowerShell Blog</a></td>
        
        <td style='width:50%; color:#564c4d; font-size:15px; font-family:Montserrat, sans-serif; text-align:right; padding-right:300px;'>
		
		 
	<div class="dropdown">
		<a href='' class="dropbtn">Articles</a>
  <div class="dropdown-content" style='line-height: 1.6;'>
		  <b>2024</b><br>
	  <a href="DominoO365.html" class=two>Domino and O365 Co-existence</a><br>
	  <a href="ADdelegate.html" class=two>Delegate Control in AD</a><br>
	  <a href="hverelay.html" class=two>App mail relay via HVE</a><br>
 <a href="hve.html" class=two>Setting up Mail Relay with HVE</a><br>
    <a href="bimi.html" class=two>Getting BIMI certified</a><br>
    <a href="occam.html" class=two>Orbea Occam SL H30</a><br>
    <a href="freesat.html" class=two>Installing FreeSat and Saorview</a><br>
    <a href="broadband.html" class=two>Changing broadband provider</a><br>
    <a href="DINtimer.html" class=two>Replacing a DIN timer on fuseboard</a><br>
    <a href="desktopNotifications.html" class=two>Outlook Desktop Notifications stop working</a><br>
    <a href="outlookFolders.html" class=two>Outlook folders keep moving sort order</a><br>
    <a href="runbooks.html" class=two>Teams report uploading to SharePoint with Runbooks</a><br>
	  <a href="teamsApplication.html" class=two>Teams PowerShell module can't run CS cmd as App</a><br>
	  
	  <details>

    <summary><b>2023</b><br></summary>
<a href="mapSharedMailbox.html" class=two>Cannot map new Shared Mailboxes in O365</a><br>
	<a href="exchangeCertRenew.html" class=two>Renewing an Exchange 2016 certificate</a><br>
	<a href="compliancePowershell.html" class=two>Connect to Compliance PowerShell behind a Proxy</a><br>
	<a href="sensitivityLabelError.html" class=two>Sensitivity Label not shown in Outlook Client</a><br>
	<a href="roomFinderError.html" class=two>Room Finder Error in Outlook</a><br>
	<a href="teamsRoom.html" class=two>Teams not showing Rooms</a><br>
	<a href="teamsFile.html" class=two>Teams unable to open file</a><br>
	<a href="reviewQuarantine.html" class=two>Unable to review quarantined mails for shared mailbox</a><br>
	<a href="setLocale.html" class=two>Set Locale for various Apps</a><br>
	<a href="delegateSentItems.html" class=two>Delegate Sent Items placed into external Tenant</a><br>
	<a href="microsoftSupport.html" class=two>Overview of Microsoft Support cases</a><br>
	<a href="centralizedMail.html" class=two>When centralized mail sends via O365</a><br>
        <a href="DNScleanup.html" class=two>Cleaning up your Windows DNS server</a><br>
        <a href="oneDriveLocale.html" class=two>Set OneDrive for Business Locale</a><br>
	<a href="o365migration.html" class=two>O365 Migration Tips</a><br>
	<a href="o365reporting.html" class=two>Reporting on successful Azure logons</a><br>
	<a href="iisQueue.html" class=two>IIS Mapi Queue full with NetScaler</a><br>
        <a href="o365cert.html" class=two>Secure Office365 reports with a certificate</a><br>
        <a href="graphMail.html" class=two>Using Graph to send emails with inline images</a><br>
        <a href="charts.html" class=two>Visualizing Graph data with Google Charts</a><br>
        <a href="alwaysOn.html" class=two>Keeping a log of NetScaler AlwaysON connections</a><br>
</details>
  </div>
</div>	
		
		| <a href='about.html' class=two>About</a> | <a href='links.html' class=two>Links</a></td></tr> 
      <tr><td style='height:1px; color:#564c4d; width:100%; border-bottom: 1px solid;' colspan=2></td></tr>
      <tr><td style='text-align:center; width:100%; padding-top:30px; padding-left:30px;' colspan=2>
     
	      
	      <div class=headline>Articles</div>
	      <table class=indexTable> 
		      <br>
	<tr><td><a href="DominoO365.html" class=two>Domino and O365 Co-existence</a><br></td><td>25-May-24</td></tr>
	<tr><td><a href="ADdelegate.html" class=two>Delegate Control in AD</a><br></td><td>22-May-24</td></tr>
	<tr><td><a href="hverelay.html" class=two>App mail relay via HVE</a><br></td><td>22-May-24</td></tr>
	<tr><td><a href="hve.html" class=two>Setting up Mail Relay with HVE</a><br></td><td>16-May-24</td></tr>
	<tr><td><a href="bimi.html" class=two>Getting BIMI certified</a></td><td>19-Feb-24</td></tr>
        <tr><td><a href="occam.html" class=two>Orbea Occam SL H30</a></td><td>19-Feb-24</td></tr>
	<tr><td><a href="freesat.html" class=two><a href="freesat.html" class=two>Replacing Virgin Media with FreeSat and Saorview</a></td><td>08-Feb-24</td></tr>
	<tr><td><a href="broadband.html" class=two>Changing broadband provider</a></td><td>08-Feb-24</td></tr>
	<tr><td><a href="DINtimer.html" class=two>Replacing a DIN timer on fuseboard</a></td><td>08-Feb-24</td></tr>
	<tr><td><a href="desktopNotifications.html" class=two>Outlook Desktop Notifications stop working</a></td><td>01-Feb-24</td></tr>
	<tr><td><a href="outlookFolders.html" class=two>Outlook folders keep moving sort order</a><br></td><td>31-Jan-24</td></tr>
	<tr><td><a href="runbooks.html" class=two>Creating a Teams report uploading to SharePoint with Runbooks</a><br></td><td>31-Jan-24</td></tr>
	<tr><td><a href="teamsApplication.html" class=two>Teams PowerShell module can't run CS cmd as App</a></td><td>19-Jan-24</td></tr>
	<tr><td><a href="mapSharedMailbox.html" class=two>Cannot map new Shared Mailboxes in O365</a></td><td>06-Dec-23</td></tr>
	<tr><td><a href="missingMailbox.html" class=two>Mailbox present in O365 but missing on-prem</a></td><td>13-Nov-23</td></tr>
	<tr><td><a href="recreatePublicFolder.html" class=two>Recreating Public Folders in Exchange Online</a></td><td>11-Oct-23</td></tr>
	<tr><td><a href="exchangeCertRenew.html" class=two>Renewing an Exchange 2016 certificate</a></td><td>23-Jun-23</td></tr>
	<tr><td><a href="compliancePowershell.html" class=two>Connect to Compliance PowerShell behind a Proxy</a></td><td>31-Mar-23</td></tr>
	<tr><td><a href="sensitivityLabelError.html" class=two>Sensitivity Label not shown in Outlook Client</a></td><td>29-Mar-23</td></tr>
	<tr><td><a href="roomFinderError.html" class=two>Room Finder Error in Outlook</a></td><td>28-Mar-23</td></tr>
	<tr><td><a href="teamsRoom.html" class=two>Teams not showing Rooms</a></td><td>25-Mar-23</td></tr>
	<tr><td><a href="teamsFile.html" class=two>Teams unable to open file</a></td><td>21-Mar-23</td></tr>
	<tr><td><a href="reviewQuarantine.html" class=two>Unable to review quarantined mails for shared mailbox</a></td><td>13-Mar-23</td></tr>
	<tr><td><a href="setLocale.html" class=two>Set Locale for various Apps</a></td><td>12-Mar-23</td></tr>
	<tr><td><a href="delegateSentItems.html" class=two>Delegate Sent Items placed into external Tenant</a></td><td>12-Mar-23</td></tr>
	<tr><td><a href="microsoftSupport.html" class=two>Overview of Microsoft Support cases</a></td><td>11-Mar-23</td></tr>
	<tr><td><a href="centralizedMail.html" class=two>When centralized mail sends via O365</a></td><td>11-Mar-23</td></tr>
  	<tr><td><a href="oneDriveLocale.html" class=two>Set OneDrive for Business Locale</a></td><td>08-Mar-23</td></tr>
	<tr><td><a href="o365migration.html" class=two>O365 Migration Tips</a></td><td>08-Mar-23</td></tr>
	<tr><td><a href="o365reporting.html" class=two>Reporting on successful Azure logons</a></td><td>06-Mar-23</td></tr>
	<tr><td><a href="iisQueue.html" class=two>IIS Mapi Queue full with NetScaler</a></td><td>02-Mar-23</td></tr>
        <tr><td><a href="o365cert.html" class=two>Secure Office365 reports with a certificate</a></td><td>02-Mar-23</td></tr>
        <tr><td><a href="graphMail.html" class=two>Using Graph to send emails with inline images</a></td><td>02-Mar-23</td></tr>
        <tr><td><a href="charts.html" class=two>Visualizing Graph data with Google Charts</a></td><td>02-Mar-23</td></tr>
        <tr><td><a href="alwaysOn.html" class=two>Keeping a log of NetScaler AlwaysON connections</a></td><td>02-Mar-23</td></tr>
        <tr><td><a href="DNScleanup.html" class=two>Cleaning up your Windows DNS server</a></td><td>01-Mar-23</td></tr>      
	      </table>
	      <br><br>
        <div class=headline>Featured Article - Cleaning up your Windows DNS server</div>
	      <div class=datestamp>01-Mar-23</div>
        <div class=content><br>
          Having contracted at a number of companies over the years I've seen my fair share of horror shows with regards DNS. For something so simple it really does have a lot of importance and should be regularly reviewed.<br>
		<br>
		In my latest role the DNS setup was quite simple and I'm happy to report DNS scavaging was enabled, so the majority of records were correct and up-to-date.<br><br>
		<img src=DNScleanup01.png class=ImageMain>
		<div class=ImageCaption>↑ Scavenging set correctly for the main AD domain zone.</div>
		<br>
		So what to check?<br>
		<li>Static records, do they still ping?</li>
		<li>Cross reference records with AD.</li>
		<li>Cross reference records with DMZ servers, hosted on VMware so we can use PowerCLI to check.</li>
		<li>Check if A record has reverse lookup record (PTR) set?</li>
		<li>With our secondary domain we had spit DNS setup, checks to ensure all records were correct.</li>
		<br>
		<img src=DNScleanup02.png style='border: 5px solid #564c4d;'>
		<div class=ImageCaption>↑ Here we use PowerShell to pull the PTR reverse records.</div>
		<br>
		What did we find? A few hundred records were wrong:<br>
		<li>About 50 A records could be deleted</li>
		<li>A number of subnets were missing for reverse DNS lookup zones.</li>
		<li>Some DMZ servers had been removed from VMware but the DNS record remained.</li>
		<li>We found that our Fortinet Site-to-Site VPN did not have rights to update the PTR record.</li>
		<li>In our split DNS zone we added an MX record, it didn't fix an issue but some of the Microsoft health scripts we ran were a lot happier with it present.</li>
		<br>
		While some of the fixes may sound trivial, when an issue occurs and you need to track down a client you will be happy to have a correct DNS setup.<br>
          <br><br> 
           
           
          </div>
          
          </td>
         
        </td></tr>
    </table> 
    

    
    
    
  </body>
  
  
  
</html>
